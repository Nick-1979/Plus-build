(()=>{var e,n,o={69314:()=>{},18983:()=>{},26234:(e,n,o)=>{"use strict";var t=o(95292),r=o(48801),a=o(52107),l=o(36631),i=o(44235),s=o(38090);const d=(0,l.Z)((async function(e){const n=new i.U(e);return await s.G.create({provider:n})}));var u=o(64021),c=o(51330),p=o(57928);const w=new Uint8Array(32),m=(0,u.d)("modl");function g(e,n,o){return e.registry.createType("AccountId32",(0,c.e)(m,e.consts.nominationPools.palletId.toU8a(),new Uint8Array([o]),(0,p.a)(n,{bitLength:32}),w)).toString()}const f=(0,l.Z)((function(e,n){return{rewardId:g(e,n,1),stashId:g(e,n,0)}}));t.nw,t.nw,t.nw,onmessage=e=>{const{endpoint:n,stakerAddress:o,id:l}=e.data;(async function(e,n,o){var l,i,s,u,c,p;console.log(`getPool is called for ${n} id:${o}`);const w=await d(e),m=!o&&await w.query.nominationPools.poolMembers(n),g=null!=m&&m.isSome?m.unwrap():void 0;if(!g&&!o)return console.log(`can not find member for ${n} or id is :${o}`),null;const b=null!==(l=null==g?void 0:g.poolId)&&void 0!==l?l:o,v=f(w,b);if(!v)return console.log(`can not find a pool with id:${o}`),null;const[y,h,P,S,x]=await Promise.all([w.query.nominationPools.metadata(b),w.query.nominationPools.bondedPools(b),w.query.nominationPools.rewardPools(b),w.query.system.account(v.rewardId),w.derive.staking.account(v.stashId)]),O=P.isSome?P.unwrap():null,k=h.isSome?h.unwrap():null;console.log("rewardPools:",JSON.parse(JSON.stringify(O)));const E=(0,a.xu)(t.nw,S.data.free.sub(w.consts.balances.existentialDeposit)),I=null!==(i=null==O?void 0:O.totalEarnings)&&void 0!==i?i:t.nw,T=(0,a.xu)(t.nw,E.sub(null!==(s=null==O?void 0:O.balance)&&void 0!==s?s:t.nw)).add(null!==(u=null==O?void 0:O.totalEarnings)&&void 0!==u?u:t.nw),j=(0,a.xu)(t.nw,T.sub(I)),$=k.points.mul(j);(null!==(c=null==O?void 0:O.points)&&void 0!==c?c:t.nw).add($),console.log("currTotalEarnings",T),console.log("member.member",g),console.log("member.rewardPoolTotalEarnings",g.rewardPoolTotalEarnings);const C=g?(0,a.xu)(t.nw,T.sub(null!==(p=null==g?void 0:g.rewardPoolTotalEarnings)&&void 0!==p?p:t.nw)):t.nw,N=(g?g.points.mul(C):t.nw,await async function(e,n,o,t,a){const l=e.consts.balances.existentialDeposit,i=(await e.query.system.account(a)).data.free.sub(l).add(new r(t.totalRewardsClaimed)).sub(new r(t.lastRecordedTotalPayouts)),s=new r(10).pow(new r(18));return i.mul(s).div(o).add(t.lastRecordedRewardCounter).sub(n.lastRecordedRewardCounter).mul(n.points).div(s)}(w,g,k.points,O,v.rewardId)),q={};O&&(q.balance=null!=O&&O.balance?String(O.balance):void 0,q.points=null!=O&&O.points?String(O.points):void 0,q.totalEarnings=null!=O&&O.totalEarnings?String(O.totalEarnings):void 0);const A={accounts:v,bondedPool:k,ledger:null==x?void 0:x.stakingLedger,member:g,metadata:y.length?y.isUtf8?y.toUtf8():y.toString():null,myClaimable:Number(N),poolId:o,redeemable:Number(null==x?void 0:x.redeemable),rewardClaimable:Number(E),rewardIdBalance:S.data,rewardPool:O,stashIdAccount:x};return JSON.stringify(A)})(n,o,l).then((e=>{postMessage(e)}))}}},t={};function r(e){var n=t[e];if(void 0!==n)return n.exports;var a=t[e]={id:e,loaded:!1,exports:{}};return o[e].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=o,r.x=()=>{var e=r.O(void 0,[593],(()=>r(26234)));return r.O(e)},e=[],r.O=(n,o,t,a)=>{if(!o){var l=1/0;for(u=0;u<e.length;u++){for(var[o,t,a]=e[u],i=!0,s=0;s<o.length;s++)(!1&a||l>=a)&&Object.keys(r.O).every((e=>r.O[e](o[s])))?o.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(u--,1);var d=t();void 0!==d&&(n=d)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,t,a]},r.d=(e,n)=>{for(var o in n)r.o(n,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((n,o)=>(r.f[o](e,n),n)),[])),r.u=e=>e+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var n=r.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var o=n.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={690:1};r.f.i=(n,o)=>{e[n]||importScripts(r.p+r.u(n))};var n=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension||[],o=n.push.bind(n);n.push=n=>{var[t,a,l]=n;for(var i in a)r.o(a,i)&&(r.m[i]=a[i]);for(l&&l(r);t.length;)e[t.pop()]=1;o(n)}})(),n=r.x,r.x=()=>r.e(593).then(n),r.x()})();