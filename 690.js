(()=>{var n,o,e={69314:()=>{},18983:()=>{},26234:(n,o,e)=>{"use strict";var t=e(95292),r=e(52107),l=e(36631),a=e(44235),i=e(38090);const s=(0,l.Z)((async function(n){const o=new a.U(n);return await i.G.create({provider:o})}));var d=e(64021),u=e(51330),c=e(57928);const p=new Uint8Array(32),g=(0,d.d)("modl");function m(n,o,e){return n.registry.createType("AccountId32",(0,u.e)(g,n.consts.nominationPools.palletId.toU8a(),new Uint8Array([e]),(0,c.a)(o,{bitLength:32}),p)).toString()}const f=(0,l.Z)((function(n,o){return{rewardId:m(n,o,1),stashId:m(n,o,0)}}));t.nw,t.nw,t.nw,onmessage=n=>{const{endpoint:o,stakerAddress:e,id:l}=n.data;(async function(n,o,e){var l,a,i,d,u,c;console.log(`getPool is called for ${o} id:${e}`);const p=await s(n),g=!e&&await p.query.nominationPools.poolMembers(o),m=null!=g&&g.isSome?g.unwrap():void 0;if(!m&&!e)return console.log(`can not find member for ${o} or id is :${e}`),null;const w=null!==(l=null==m?void 0:m.poolId)&&void 0!==l?l:e,v=f(p,w);if(!v)return console.log(`can not find a pool with id:${e}`),null;const[b,y,h,P,S]=await Promise.all([p.query.nominationPools.metadata(w),p.query.nominationPools.bondedPools(w),p.query.nominationPools.rewardPools(w),p.query.system.account(v.rewardId),p.derive.staking.account(v.stashId)]),x=h.isSome?h.unwrap():null,O=y.isSome?y.unwrap():null;console.log("rewardPools:",JSON.parse(JSON.stringify(x)));const k=(0,r.xu)(t.nw,P.data.free.sub(p.consts.balances.existentialDeposit)),E=null!==(a=null==x?void 0:x.totalEarnings)&&void 0!==a?a:t.nw,I=(0,r.xu)(t.nw,k.sub(null!==(i=null==x?void 0:x.balance)&&void 0!==i?i:t.nw)).add(null!==(d=null==x?void 0:x.totalEarnings)&&void 0!==d?d:t.nw),T=(0,r.xu)(t.nw,I.sub(E)),j=O.points.mul(T),$=(null!==(u=null==x?void 0:x.points)&&void 0!==u?u:t.nw).add(j);console.log("currTotalEarnings",I),console.log("member.member",m),console.log("member.rewardPoolTotalEarnings",m.rewardPoolTotalEarnings);const N=m?(0,r.xu)(t.nw,I.sub(null!==(c=null==m?void 0:m.rewardPoolTotalEarnings)&&void 0!==c?c:t.nw)):t.nw,A=m?m.points.mul(N):t.nw,U=A.isZero()||$.isZero()||k.isZero()?t.nw:A.mul(k).div($),_={};x&&(_.balance=null!=x&&x.balance?String(x.balance):void 0,_.points=null!=x&&x.points?String(x.points):void 0,_.totalEarnings=null!=x&&x.totalEarnings?String(x.totalEarnings):void 0);const q={accounts:v,bondedPool:O,ledger:null==S?void 0:S.stakingLedger,member:m,metadata:b.length?b.isUtf8?b.toUtf8():b.toString():null,myClaimable:Number(U),poolId:e,redeemable:Number(null==S?void 0:S.redeemable),rewardClaimable:Number(k),rewardIdBalance:P.data,rewardPool:_,stashIdAccount:S};return JSON.stringify(q)})(o,e,l).then((n=>{postMessage(n)}))}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var l=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(l.exports,l,l.exports,r),l.loaded=!0,l.exports}r.m=e,r.x=()=>{var n=r.O(void 0,[593],(()=>r(26234)));return r.O(n)},n=[],r.O=(o,e,t,l)=>{if(!e){var a=1/0;for(u=0;u<n.length;u++){for(var[e,t,l]=n[u],i=!0,s=0;s<e.length;s++)(!1&l||a>=l)&&Object.keys(r.O).every((n=>r.O[n](e[s])))?e.splice(s--,1):(i=!1,l<a&&(a=l));if(i){n.splice(u--,1);var d=t();void 0!==d&&(o=d)}}return o}l=l||0;for(var u=n.length;u>0&&n[u-1][2]>l;u--)n[u]=n[u-1];n[u]=[e,t,l]},r.d=(n,o)=>{for(var e in o)r.o(o,e)&&!r.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:o[e]})},r.f={},r.e=n=>Promise.all(Object.keys(r.f).reduce(((o,e)=>(r.f[e](n,o),o)),[])),r.u=n=>n+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),r.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),r.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.nmd=n=>(n.paths=[],n.children||(n.children=[]),n),(()=>{var n;r.g.importScripts&&(n=r.g.location+"");var o=r.g.document;if(!n&&o&&(o.currentScript&&(n=o.currentScript.src),!n)){var e=o.getElementsByTagName("script");e.length&&(n=e[e.length-1].src)}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=n})(),(()=>{var n={690:1};r.f.i=(o,e)=>{n[o]||importScripts(r.p+r.u(o))};var o=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension=("undefined"!=typeof self?self:this).webpackChunk_polkadot_extension||[],e=o.push.bind(o);o.push=o=>{var[t,l,a]=o;for(var i in l)r.o(l,i)&&(r.m[i]=l[i]);for(a&&a(r);t.length;)n[t.pop()]=1;e(o)}})(),o=r.x,r.x=()=>r.e(593).then(o),r.x()})();